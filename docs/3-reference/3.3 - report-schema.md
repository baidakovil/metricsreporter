## Reference: Metrics Report Artifacts

This document describes the JSON payloads produced by Metrics Reporter: `MetricsReport.g.json`, `MetricsBaseline.g.json`, and companion files such as `SuppressedSymbols.g.json`.

### Core objects

| Field | Type | Description |
| --- | --- | --- |
| `metadata.generatedAtUtc` | ISO 8601 string | Timestamp of report generation (UTC). |
| `metadata.paths` | object | Paths used during the run (`metricsDirectory`, `baseline`, `report`, `html`, `thresholds`). Useful for provenance. |
| `metadata.thresholdsByLevel` | object | Per-metric thresholds by node level (Solution/Assembly/Namespace/Type/Member). Each entry includes `warning`, `error`, and `higherIsBetter`. |
| `metadata.metricDescriptors` | object | Unit/type info for every metric identifier (e.g., `{ "AltCoverSequenceCoverage": { "unit": "percent" } }`). |
| `metadata.metricAliases` | object | Optional aliases per metric identifier. Keys are canonical IDs; values are arrays of alias strings used by CLI resolution and HTML tooltips. |
| `metadata.excludedMemberNamesPatterns` | string | Comma- or semicolon-separated wildcard patterns used to remove compiler-produced members. |
| `metadata.excludeMethods` / `excludeProperties` / `excludeFields` / `excludeEvents` | bool | Member-kind flags applied during generation. Default `false` (no exclusion) when omitted. |
| `solution` | object | Root node with `name`, `kind="Solution"`, and `assemblies[]`. |

### Code element nodes

Every node shares the same shape:

| Field | Type | Notes |
| --- | --- | --- |
| `name` | string | Display name. |
| `kind` | `"Solution" | "Assembly" | "Namespace" | "Type" | "Member"` | Used by the HTML drilldown script. |
| `fullyQualifiedName` | string? | Present for `Assembly`, `Type`, `Member`. Uses dot notation with `(...)` placeholder for method parameters. Generic parameters and constraints on method names are stripped (e.g., `Method<TKey, TValue>(...)`, `Method<T>() where T : class` → `Method(...)`). |
| `memberKind` | `"Unknown" | "Method" | "Property" | "Field" | "Event"` | Present only for member nodes. |
| `isNew` | bool? | `true` when the node has no baseline match (HTML prefixes it with `NEW`). |
| `source.path` | string? | Source file path relative to the repository root. |
| `source.startLine` / `source.endLine` | int? | Helpful for tooling links. |
| `metrics` | object | Dictionary keyed by `MetricIdentifier`. See below. |
| `assemblies` / `namespaces` / `types` / `members` | arrays | Present according to the node level. Empty arrays are omitted to keep the JSON compact. |

### Metric values

Each entry inside `metrics` looks like:

```json
"RoslynClassCoupling": {
  "value": 72,
  "delta": 5,
  "status": "Error",
  "breakdown": [
    {
      "ruleId": "CA1506",
      "message": "Avoid excessive class coupling",
      "uri": "src/Sample.Loader/Services/CommandValidationService.cs",
      "startLine": 42,
      "endLine": 78
    }
  ]
}
```

| Field | Meaning |
| --- | --- |
| `value` | Current measurement (`decimal` for coverage/complexity, `int` for counts). |
| `delta` | Difference versus baseline. Omitted when zero or when no baseline exists. |
| `status` | Comparison against thresholds (`Success`, `Warning`, `Error`). |
| `breakdown` | Optional array used for SARIF metrics; each item tracks rule metadata and source locations. |

If a metric is not present, it is either not applicable to the node or the upstream data source produced no value. `NotApplicable` statuses are filtered out before serialization.

Metric aliases in `metadata.metricAliases` are surfaced in the HTML dashboard: column header tooltips show the canonical identifier plus configured aliases so users can discover friendly names without re-running the generator.

### Baseline file

`MetricsBaseline.g.json` shares the same schema as `MetricsReport.g.json`. During generation:

1. If `ReplaceMetricsBaseline=true` and the baseline file is missing but a previous report exists, that report is copied to the baseline location before aggregation starts.
2. After a successful run, the new report overwrites the baseline (after archiving the previous baseline in `MetricsReportStoragePath` with a timestamp suffix).

This ensures deltas are always calculated against the most recent report without manual intervention.

### Suppressed symbols

`SuppressedSymbols.g.json` is a flat array:

```json
[
  {
    "fullyQualifiedName": "Sample.Loader.Services.CommandValidationService.ValidateAsync(...)",
    "target": "Member",
    "rule": "CA1506",
    "metric": "RoslynClassCoupling",
    "justification": "Too much coupling during prototype stage"
  }
]
```

- `metric` maps `[SuppressMessage(Category="Microsoft.Maintainability", CheckId="CA1506")]` to the corresponding metric identifier (`RoslynClassCoupling`).
- During aggregation, suppressed entries are attached to the matching nodes so the HTML dashboard and CLI can hide them by default while still exposing the justification on demand.

### Related schema files

- `MetricsReporter/Model/metrics-report.schema.json` – authoritative JSON schema for reports and baselines.
- `MetricsReporter/Model/suppressed-symbols.schema.json` – schema for `SuppressedSymbols.g.json`.

Keep these in sync when you introduce new metadata or metrics; they power validation inside tests and tooling.

