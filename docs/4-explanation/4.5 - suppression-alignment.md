## Explanation: Suppression Alignment and Namespace-Aware Tooling

Suppressions (`[SuppressMessage]`) and CLI namespace filters rely on stable fully qualified names (FQNs). When nested types, iterator classes, and multiple data sources get mixed, those FQNs can drift unless we normalize aggressively. This document describes how Metrics Reporter keeps suppressions and tooling aligned.

### Coverage suppression vs. exclusion

- **Prefer suppression for coverage noise:** keep OpenCover metrics in the report and mark noisy symbols as suppressed so HTML shows both the value and the justification. This preserves visibility and trend tracking.
- **Avoid attribute-based exclusion:** `OpenCoverAttributeFilter=System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute` removes symbols from coverage XML and the HTML table entirely. Leave this property empty to retain metrics.
- **How to suppress coverage:** add `[SuppressMessage("Coverage", "OpenCoverBranchCoverage", Justification = "...")]` (or `OpenCoverSequenceCoverage`) on the target member/type. The analyzer will emit `Metric = "OpenCoverBranchCoverage"` into `SuppressedSymbols.g.json`; HTML renders a suppressed overlay with the tooltip justification.
- **FQNs stay aligned:** suppression entries use the same normalized names as coverage nodes (`Namespace.Type.Method(...)`, `Namespace.Type`), so the HTML renderer can apply `data-suppressed="true"` to the matching cells.
- **CLI visibility:** `--include-suppressed` still governs whether suppressed rows show up in CLI `read` output; HTML always shows the suppressed styling when suppression metadata is present.

### Building consistent FQNs

- `FullyQualifiedNameBuilder` maintains parallel stacks for namespaces and types while walking the aggregated tree. Nested types become `Namespace.Outer.Inner`, even if OpenCover originally emitted `Outer/Nested` or `Outer+Nested`.
- Suppression analysis maps Roslyn rule IDs to metric identifiers (e.g., `CA1506` → `RoslynClassCoupling`) and stores the resulting entries in `SuppressedSymbols.g.json`, keyed by the normalized FQNs above.

### Namespace-aware queries

- `NamespaceMatcher` (used by `metrics-reader`) treats `.`, `+`, and `:` as acceptable separators immediately after the namespace prefix. Queries such as `metrics-reader readany --namespace MetricsReporter --symbol-kind Type` therefore match both `MetricsReporter.Aggregation.StructuralElementMerger` and any nested types (`MetricsReporter.Aggregation.StructuralElementMerger.MemberResolutionContext`).
- CLI flags like `--include-suppressed` simply toggle whether suppressed entries are filtered during symbol queries; no extra mapping is required because the FQNs already align.

### Practical effects

- HTML lists each nested type only once, with suppressions, coverage, and SARIF breakdowns consolidated on that row.
- Baseline comparisons do not “forget” suppressions when only OpenCover or SARIF reported a symbol—the normalized FQN remains stable.
- AI agents (and humans) can reason about suppressions by reviewing `SuppressedSymbols.g.json`, knowing the entries match the identifiers shown in dashboards and CLI output.

